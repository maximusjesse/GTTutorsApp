Drop View Summary1, Summary2, TutorInfo, TutorSchedule, ProfessorRecs, StudentRecs, CombinedRecExtra, RecsTTS, Figure3;
CREATE VIEW Summary1 AS SELECT CONCAT(tts.School, CAST(tts.Number as char)) as 'Course', tts.Semester, Count(tts.TuteeID) as 'NumStudents', Count(t.TutorID) as 'NumTutors' FROM Tutors t, TutorTimeSlots tts WHERE t.TutorID=tts.TutorID Group by Course, Semester;
CREATE VIEW Summary2 AS	SELECT CONCAT(t.School, CAST(t.Number as char)) as 'Course', tts.Semester, Count(g.GradID) as 'TA', AVG(r.numEvaluation) as 'AvgRating', Count(u.undergradID) as 'nonTA', AVG(r2.numEvaluation) as 'AvgRating2' FROM Tutors t, TutorTimeSlots tts, Grad g, Rates r, Undergrad u, Rates r2 WHERE t.TutorID=tts.TutorID AND g.GradID=r.TutorID AND u.UndergradID=r2.TutorID Group by Course, Semester Order by Course;
CREATE VIEW TutorInfo AS SELECT s.Name, s.Email, Avg(r.NumEvaluation) as 'AvgProfRating', Count(distinct r.ProfessorID) as 'NumProfessors', Avg(ra.NumEvaluation) as 'AvgStudentRating', Count(distinct ra.StudentID) as 'NumStudents', s.StudentID as 'TutorID' FROM Student s, Recommends r, Rates ra Where s.StudentID=r.TutorID AND s.StudentID=ra.TutorID;
CREATE VIEW TutorSchedule AS SELECT tts.Weekday as 'Day', tts.Time, s.Name, s.Email, CONCAT(tts.School, CAST(tts.Number as char)) as 'Course', s.StudentID From TutorTimeSlots tts, Student s Where tts.TutorID=s.StudentID;
CREATE VIEW ProfessorRecs AS SELECT TutorID as ProfTutorID, Count(*) as ProfNumRatings, Avg(NumEvaluation) as ProfAvgRating From Recommends Group by TutorID;
CREATE VIEW StudentRecs AS SELECT TutorID as StuTutorID, Count(*) as StuNumRatings, Avg(NumEvaluation) as StuAvgRating From Rates  Group by TutorID;
CREATE VIEW CombinedRecExtra AS	SELECT * FROM ProfessorRecs PR LEFT JOIN StudentRecs SR	ON PR.ProfTutorID=SR.StuTutorID	UNION SELECT * FROM ProfessorRecs PR RIGHT JOIN StudentRecs SR ON PR.ProfTutorID=SR.StuTutorID;
CREATE VIEW RecsTTS as	SELECT * FROM CombinedRecExtra cre INNER JOIN TutorTimeSlots A on cre.ProfTutorID=A.TutorID;
CREATE VIEW Figure3 AS SELECT s.Name, s.Email, r.profTutorID, r.ProfNumRatings, r.ProfAvgRating, r.StuTutorID, r.StuNumRatings, r.StuAvgRating, r.School, r.Number, r.TutorID, r.Time, r.Semester, r.Weekday, r.TuteeID From Student s, RecsTTS r Where s.StudentID=r.TutorID;